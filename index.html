<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complete AI Portfolio Dashboard - Production Fixed</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.13.0/dist/tf.min.js"></script>
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container { 
            max-width: 1800px; 
            margin: 0 auto; 
            padding: 20px; 
        }
        
        .header {
            background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
            color: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        
        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .status-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }
        
        .status-live { background: #22c55e; }
        .status-error { background: #ef4444; }
        .status-loading { background: #f59e0b; }
        
        @keyframes pulse {
            0% { transform: scale(0.95); opacity: 1; }
            70% { transform: scale(1.05); opacity: 0.7; }
            100% { transform: scale(0.95); opacity: 1; }
        }
        
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .panel {
            background: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #667eea;
        }
        
        .panel h3 {
            color: #1e40af;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .holdings-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        .holdings-table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 10px;
            text-align: left;
            font-weight: 600;
            font-size: 0.85rem;
        }
        
        .holdings-table td {
            padding: 10px;
            border-bottom: 1px solid #e5e7eb;
            font-size: 0.85rem;
        }
        
        .holdings-table tr:hover {
            background: #f8fafc;
        }
        
        .positive { color: #22c55e; font-weight: 500; }
        .negative { color: #ef4444; font-weight: 500; }
        .neutral { color: #64748b; }
        
        .chart-container {
            position: relative;
            height: 350px;
            margin: 15px 0;
        }
        
        .sip-history {
            max-height: 120px;
            overflow-y: auto;
            font-size: 0.8rem;
        }
        
        .sip-entry {
            display: flex;
            justify-content: space-between;
            padding: 4px 8px;
            margin: 2px 0;
            background: #f8fafc;
            border-radius: 4px;
        }
        
        .metric-card {
            background: #f8fafc;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            margin: 10px 0;
        }
        
        .metric-value {
            font-size: 1.8rem;
            font-weight: 700;
            margin: 8px 0;
        }
        
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            margin: 4px;
        }
        
        .btn-primary { background: #3b82f6; color: white; }
        .btn-success { background: #22c55e; color: white; }
        .btn-warning { background: #f59e0b; color: white; }
        .btn-sm { padding: 6px 12px; font-size: 0.8rem; }
        
        .error-message {
            background: #fee2e2;
            border: 1px solid #ef4444;
            color: #dc2626;
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
            font-size: 0.9rem;
        }
        
        .loading-spinner {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid #f3f3f3;
            border-top: 2px solid #3b82f6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @media (max-width: 768px) {
            .container { padding: 10px; }
            .dashboard-grid { grid-template-columns: 1fr; }
            .holdings-table { font-size: 0.75rem; }
            .holdings-table th, .holdings-table td { padding: 8px 6px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Enhanced Header with Live Status -->
        <div class="header">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <div>
                    <h1><i class="fas fa-satellite-dish"></i> Complete AI Portfolio Dashboard</h1>
                    <p style="margin-top: 8px;">Real-Time NAV Updates â€¢ Neural Networks â€¢ SIP Optimization â€¢ Performance Analytics</p>
                </div>
                <div style="text-align: right;">
                    <div style="font-size: 1.3rem; font-weight: 600;" id="portfolioValue">
                        â‚¹<span id="totalValue">1,44,867</span>
                    </div>
                    <div style="margin-top: 5px;" id="lastUpdate">
                        Last Update: July 27, 2025, 7:00 AM IST
                    </div>
                </div>
            </div>
            
            <div class="status-grid">
                <div class="status-card">
                    <div class="status-indicator status-loading" id="navIndicator"></div>
                    <div>
                        <div style="font-weight: 600;">AMFI NAV Updates</div>
                        <div style="font-size: 0.8rem;" id="navStatus">Connecting...</div>
                    </div>
                </div>
                
                <div class="status-card">
                    <div class="status-indicator status-loading" id="neuralIndicator"></div>
                    <div>
                        <div style="font-weight: 600;">Neural Networks</div>
                        <div style="font-size: 0.8rem;" id="neuralStatus">Loading models...</div>
                    </div>
                </div>
                
                <div class="status-card">
                    <div class="status-indicator status-loading" id="sipIndicator"></div>
                    <div>
                        <div style="font-weight: 600;">SIP Optimization</div>
                        <div style="font-size: 0.8rem;" id="sipStatus">Analyzing...</div>
                    </div>
                </div>
                
                <div class="status-card">
                    <div class="status-indicator status-loading" id="analyticsIndicator"></div>
                    <div>
                        <div style="font-weight: 600;">Performance Analytics</div>
                        <div style="font-size: 0.8rem;" id="analyticsStatus">Computing...</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Dashboard Grid -->
        <div class="dashboard-grid">
            
            <!-- Portfolio Holdings Panel -->
            <div class="panel" style="grid-column: span 2;">
                <h3><i class="fas fa-list"></i> Live Portfolio Holdings (8 Funds)</h3>
                <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                    <button class="btn btn-primary btn-sm" onclick="refreshNAVs()">
                        <i class="fas fa-sync-alt"></i> Refresh NAVs
                    </button>
                    <button class="btn btn-success btn-sm" onclick="exportData()">
                        <i class="fas fa-download"></i> Export
                    </button>
                </div>
                
                <div style="overflow-x: auto;">
                    <table class="holdings-table">
                        <thead>
                            <tr>
                                <th>Fund Name</th>
                                <th>Live NAV</th>
                                <th>Day Change</th>
                                <th>Week Change</th>
                                <th>Current Value</th>
                                <th>P&L</th>
                                <th>AI Score</th>
                                <th>Neural Pred</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="holdingsTableBody">
                            <!-- Holdings populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- SIP Tracking Panel -->
            <div class="panel">
                <h3><i class="fas fa-calendar-alt"></i> SIP Tracking & Optimization</h3>
                
                <div class="metric-card">
                    <div style="font-size: 0.9rem; color: #64748b;">Total Monthly SIP</div>
                    <div class="metric-value positive" id="totalSIP">â‚¹14,500</div>
                    <div style="font-size: 0.8rem; color: #64748b;">Next SIP: Aug 1, 2025</div>
                </div>
                
                <h4 style="margin: 20px 0 10px 0;">SIP Schedule</h4>
                <div id="sipSchedule">
                    <!-- SIP schedule populated by JavaScript -->
                </div>
                
                <h4 style="margin: 20px 0 10px 0;">AI SIP Optimization</h4>
                <div id="sipOptimization">
                    <div style="background: #f0f9ff; padding: 12px; border-radius: 8px; margin: 8px 0;">
                        <strong>Recommendation:</strong> Reduce PP Conservative SIP from â‚¹3,000 to â‚¹2,400 on Aug 1
                    </div>
                    <div style="background: #fef3c7; padding: 12px; border-radius: 8px; margin: 8px 0;">
                        <strong>Alert:</strong> DSP Healthcare sector allocation at 19.1% - Consider pausing SIP
                    </div>
                </div>
                
                <div class="chart-container">
                    <canvas id="sipChart"></canvas>
                </div>
            </div>
            
            <!-- Performance Analytics Panel -->
            <div class="panel">
                <h3><i class="fas fa-chart-line"></i> Performance Analytics</h3>
                
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-bottom: 20px;">
                    <div class="metric-card">
                        <div style="font-size: 0.8rem; color: #64748b;">Current XIRR</div>
                        <div class="metric-value positive">68.8%</div>
                    </div>
                    <div class="metric-card">
                        <div style="font-size: 0.8rem; color: #64748b;">Total Returns</div>
                        <div class="metric-value positive">+7.16%</div>
                    </div>
                    <div class="metric-card">
                        <div style="font-size: 0.8rem; color: #64748b;">Risk Score</div>
                        <div class="metric-value" style="color: #f59e0b;">6.2/10</div>
                    </div>
                    <div class="metric-card">
                        <div style="font-size: 0.8rem; color: #64748b;">Sharpe Ratio</div>
                        <div class="metric-value" style="color: #3b82f6;">1.85</div>
                    </div>
                </div>
                
                <div class="chart-container">
                    <canvas id="performanceChart"></canvas>
                </div>
            </div>
            
            <!-- Neural Network Panel -->
            <div class="panel">
                <h3><i class="fas fa-brain"></i> Neural Network Predictions</h3>
                
                <div id="neuralStatus">
                    <div class="loading-spinner"></div> Loading neural network models...
                </div>
                
                <div id="neuralPredictions" style="display: none;">
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin: 15px 0;">
                        <div class="metric-card">
                            <div style="font-size: 0.8rem; color: #64748b;">7-Day Prediction</div>
                            <div class="metric-value positive" id="pred7d">+2.8%</div>
                            <div style="font-size: 0.7rem;">Confidence: <span id="conf7d">87%</span></div>
                        </div>
                        <div class="metric-card">
                            <div style="font-size: 0.8rem; color: #64748b;">30-Day Prediction</div>
                            <div class="metric-value positive" id="pred30d">+8.5%</div>
                            <div style="font-size: 0.7rem;">Confidence: <span id="conf30d">72%</span></div>
                        </div>
                    </div>
                    
                    <div class="chart-container">
                        <canvas id="neuralChart"></canvas>
                    </div>
                </div>
            </div>
            
            <!-- Market Data Panel -->
            <div class="panel">
                <h3><i class="fas fa-globe"></i> Live Market Data</h3>
                
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
                    <div class="metric-card">
                        <div style="font-size: 0.8rem; color: #64748b;">USD/INR</div>
                        <div class="metric-value" id="usdInr">â‚¹86.46</div>
                        <div id="usdChange" class="positive">+3.65%</div>
                    </div>
                    <div class="metric-card">
                        <div style="font-size: 0.8rem; color: #64748b;">EUR/INR</div>
                        <div class="metric-value" id="eurInr">â‚¹101.60</div>
                        <div id="eurChange" class="positive">+11.43%</div>
                    </div>
                    <div class="metric-card">
                        <div style="font-size: 0.8rem; color: #64748b;">Nifty 50</div>
                        <div class="metric-value" id="nifty50">24,613</div>
                        <div id="niftyChange" class="positive">+0.92%</div>
                    </div>
                    <div class="metric-card">
                        <div style="font-size: 0.8rem; color: #64748b;">Gold (â‚¹/10g)</div>
                        <div class="metric-value" id="goldPrice">â‚¹6,891</div>
                        <div id="goldChange" class="positive">+1.32%</div>
                    </div>
                </div>
            </div>
            
            <!-- SIP History Panel -->
            <div class="panel">
                <h3><i class="fas fa-history"></i> SIP Transaction History</h3>
                
                <div style="margin-bottom: 15px;">
                    <button class="btn btn-primary btn-sm" onclick="viewFullSIPHistory()">
                        <i class="fas fa-eye"></i> View Full History
                    </button>
                    <button class="btn btn-success btn-sm" onclick="exportSIPData()">
                        <i class="fas fa-download"></i> Export SIP Data
                    </button>
                </div>
                
                <div id="sipHistoryContainer">
                    <h4 style="margin-bottom: 10px;">Recent SIP Transactions</h4>
                    <div class="sip-history" id="recentSIPs">
                        <!-- Recent SIP transactions populated by JavaScript -->
                    </div>
                </div>
                
                <div class="chart-container">
                    <canvas id="sipHistoryChart"></canvas>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Complete Production Portfolio Manager with All Fixes
        class FixedPortfolioManager {
            constructor() {
                this.funds = this.initializeAllFunds();
                this.navUpdateInterval = 30 * 60 * 1000; // 30 minutes
                this.neuralModel = null;
                this.isNeuralModelLoaded = false;
                this.sipHistory = this.loadSIPHistory();
                this.performanceHistory = this.loadPerformanceHistory();
                
                this.init();
            }

            async init() {
                console.log('ðŸš€ Initializing Fixed Portfolio Manager...');
                
                try {
                    this.renderAllPanels();
                    await this.loadNeuralNetworks();
                    await this.updateLiveNAVs();
                    await this.updateMarketData();
                    this.startAutoRefresh();
                    
                    console.log('âœ… Fixed portfolio manager initialized successfully');
                } catch (error) {
                    console.error('âŒ Initialization failed:', error);
                    this.handleError('Initialization failed', error);
                }
            }

            initializeAllFunds() {
                return [
                    {
                        fundCode: 'DSP_HC_DIR',
                        fundName: 'DSP Healthcare Fund - Direct Growth',
                        isin: 'INF740KA1LG1',
                        amfiCode: '102885',
                        category: 'Sectoral',
                        currentNAV: 44.798,
                        previousNAV: 44.652,
                        weekAgoNAV: 43.891,
                        units: 617.919,
                        currentValue: 27681,
                        investedValue: 27099,
                        allocation: 19.1,
                        status: 'active',
                        sipAmount: 3000,
                        sipDate: 15,
                        nextSipDate: '2025-08-15',
                        aiScore: 0,
                        neuralPrediction: 0,
                        lastUpdated: null,
                        sipHistory: [
                            { date: '2025-07-15', amount: 3000, nav: 44.25, units: 67.83 },
                            { date: '2025-06-15', amount: 3000, nav: 43.80, units: 68.49 },
                            { date: '2025-05-15', amount: 3000, nav: 42.95, units: 69.85 }
                        ]
                    },
                    {
                        fundCode: 'HDFC_GOLD_DIR',
                        fundName: 'HDFC Gold ETF Fund of Fund - Direct Growth',
                        isin: 'INF179K01VX0',
                        amfiCode: '102979',
                        category: 'Gold ETF',
                        currentNAV: 31.0659,
                        previousNAV: 30.8234,
                        weekAgoNAV: 29.7845,
                        units: 714.511,
                        currentValue: 22201,
                        investedValue: 18849,
                        allocation: 15.3,
                        status: 'active',
                        sipAmount: 2000,
                        sipDate: 1,
                        nextSipDate: '2025-08-01',
                        aiScore: 0,
                        neuralPrediction: 0,
                        lastUpdated: null,
                        sipHistory: [
                            { date: '2025-07-01', amount: 2000, nav: 30.45, units: 65.68 },
                            { date: '2025-06-01', amount: 2000, nav: 29.80, units: 67.11 },
                            { date: '2025-05-01', amount: 2000, nav: 28.95, units: 69.09 }
                        ]
                    },
                    {
                        fundCode: 'HDFC_N500_DIR',
                        fundName: 'HDFC Nifty 500 Multicap Fund - Direct Growth',
                        isin: 'INF179KC1IO9',
                        amfiCode: '103045',
                        category: 'Index Fund',
                        currentNAV: 9.9921,
                        previousNAV: 9.9234,
                        weekAgoNAV: 9.7845,
                        units: 1894.97,
                        currentValue: 18934,
                        investedValue: 17749,
                        allocation: 13.1,
                        status: 'active',
                        sipAmount: 2000,
                        sipDate: 20,
                        nextSipDate: '2025-08-20',
                        aiScore: 0,
                        neuralPrediction: 0,
                        lastUpdated: null,
                        sipHistory: [
                            { date: '2025-07-20', amount: 2000, nav: 9.85, units: 203.05 },
                            { date: '2025-06-20', amount: 2000, nav: 9.65, units: 207.25 },
                            { date: '2025-05-20', amount: 2000, nav: 9.45, units: 211.64 }
                        ]
                    },
                    {
                        fundCode: 'PP_CONS_DIR',
                        fundName: 'Parag Parikh Conservative Hybrid Fund - Direct Growth',
                        isin: 'INF879O01175',
                        amfiCode: '102876',
                        category: 'Conservative Hybrid',
                        currentNAV: 15.3712,
                        previousNAV: 15.3456,
                        weekAgoNAV: 15.1234,
                        units: 1962.472,
                        currentValue: 30167,
                        investedValue: 28499,
                        allocation: 20.8,
                        status: 'active',
                        sipAmount: 3000,
                        sipDate: 1,
                        nextSipDate: '2025-08-01',
                        aiScore: 0,
                        neuralPrediction: 0,
                        lastUpdated: null,
                        sipHistory: [
                            { date: '2025-07-01', amount: 3000, nav: 15.25, units: 196.72 },
                            { date: '2025-06-01', amount: 3000, nav: 15.10, units: 198.68 },
                            { date: '2025-05-01', amount: 3000, nav: 14.95, units: 200.67 }
                        ]
                    },
                    {
                        fundCode: 'PP_FLEXI_DIR',
                        fundName: 'Parag Parikh Flexi Cap Fund - Direct Growth',
                        isin: 'INF879O01027',
                        amfiCode: '102851',
                        category: 'Flexi Cap',
                        currentNAV: 92.5071,
                        previousNAV: 91.8765,
                        weekAgoNAV: 89.4567,
                        units: 149.502,
                        currentValue: 13831,
                        investedValue: 12999,
                        allocation: 9.5,
                        status: 'active',
                        sipAmount: 1500,
                        sipDate: 15,
                        nextSipDate: '2025-08-15',
                        aiScore: 0,
                        neuralPrediction: 0,
                        lastUpdated: null,
                        sipHistory: [
                            { date: '2025-07-15', amount: 1500, nav: 91.20, units: 16.45 },
                            { date: '2025-06-15', amount: 1500, nav: 89.80, units: 16.71 },
                            { date: '2025-05-15', amount: 1500, nav: 88.45, units: 16.96 }
                        ]
                    },
                    {
                        fundCode: 'MO_ELSS_DIR',
                        fundName: 'Motilal Oswal ELSS Tax Saver Fund - Direct Growth',
                        isin: 'INF247L01569',
                        amfiCode: '102892',
                        category: 'ELSS',
                        currentNAV: 61.4999,
                        previousNAV: 61.2345,
                        weekAgoNAV: 59.8765,
                        units: 324.375,
                        currentValue: 19945,
                        investedValue: 18499,
                        allocation: 13.8,
                        status: 'active',
                        sipAmount: 2000,
                        sipDate: 25,
                        nextSipDate: '2025-08-25',
                        aiScore: 0,
                        neuralPrediction: 0,
                        lastUpdated: null,
                        sipHistory: [
                            { date: '2025-07-25', amount: 2000, nav: 60.85, units: 32.87 },
                            { date: '2025-06-25', amount: 2000, nav: 59.60, units: 33.56 },
                            { date: '2025-05-25', amount: 2000, nav: 58.40, units: 34.25 }
                        ]
                    },
                    {
                        fundCode: 'MO_SMALL_DIR',
                        fundName: 'Motilal Oswal Small Cap Fund - Direct Growth',
                        isin: 'INF247L01BY3',
                        amfiCode: '102834',
                        category: 'Small Cap',
                        currentNAV: 14.6172,
                        previousNAV: 14.5234,
                        weekAgoNAV: 14.1234,
                        units: 691.097,
                        currentValue: 10102,
                        investedValue: 9500,
                        allocation: 7.0,
                        status: 'active',
                        sipAmount: 1000,
                        sipDate: 10,
                        nextSipDate: '2025-08-10',
                        aiScore: 0,
                        neuralPrediction: 0,
                        lastUpdated: null,
                        sipHistory: [
                            { date: '2025-07-10', amount: 1000, nav: 14.35, units: 69.69 },
                            { date: '2025-06-10', amount: 1000, nav: 14.05, units: 71.17 },
                            { date: '2025-05-10', amount: 1000, nav: 13.80, units: 72.46 }
                        ]
                    },
                    {
                        fundCode: 'INV_PAN_EUR_DIR',
                        fundName: 'Invesco India Pan European Equity Fund - Direct Growth',
                        isin: 'INF205K01A24',
                        amfiCode: '102798',
                        category: 'International',
                        currentNAV: 21.6073,
                        previousNAV: 21.5234,
                        weekAgoNAV: 21.3456,
                        units: 92.921,
                        currentValue: 2008,
                        investedValue: 2000,
                        allocation: 1.4,
                        status: 'paused',
                        sipAmount: 0,
                        sipDate: null,
                        nextSipDate: 'On Hold Till September',
                        aiScore: 0,
                        neuralPrediction: 0,
                        lastUpdated: null,
                        sipHistory: [
                            { date: '2025-06-25', amount: 1000, nav: 21.25, units: 47.06 },
                            { date: '2025-05-25', amount: 1000, nav: 21.10, units: 47.39 }
                        ]
                    }
                ];
            }

            loadSIPHistory() {
                // Load SIP history from localStorage or initialize
                const saved = localStorage.getItem('sipHistory');
                if (saved) {
                    return JSON.parse(saved);
                }
                
                // Initialize with recent SIP data
                return {
                    totalInvested: 135193,
                    totalSIPs: 47,
                    avgSIPAmount: 2877,
                    lastSIPDate: '2025-07-25',
                    nextSIPDate: '2025-08-01',
                    monthlySIPSchedule: [
                        { date: '2025-08-01', funds: ['PP_CONS_DIR', 'HDFC_GOLD_DIR'], amount: 5000 },
                        { date: '2025-08-10', funds: ['MO_SMALL_DIR'], amount: 1000 },
                        { date: '2025-08-15', funds: ['DSP_HC_DIR', 'PP_FLEXI_DIR'], amount: 4500 },
                        { date: '2025-08-20', funds: ['HDFC_N500_DIR'], amount: 2000 },
                        { date: '2025-08-25', funds: ['MO_ELSS_DIR'], amount: 2000 }
                    ]
                };
            }

            loadPerformanceHistory() {
                // Load performance history from localStorage or initialize
                const saved = localStorage.getItem('performanceHistory');
                if (saved) {
                    return JSON.parse(saved);
                }
                
                // Initialize with sample performance data
                return {
                    monthly: [
                        { month: '2025-01', value: 125000, invested: 120000, xirr: 45.2 },
                        { month: '2025-02', value: 128500, invested: 123000, xirr: 52.1 },
                        { month: '2025-03', value: 132000, invested: 126000, xirr: 58.3 },
                        { month: '2025-04', value: 135800, invested: 129000, xirr: 62.7 },
                        { month: '2025-05', value: 139200, invested: 132000, xirr: 65.4 },
                        { month: '2025-06', value: 142100, invested: 135000, xirr: 67.8 },
                        { month: '2025-07', value: 144867, invested: 135193, xirr: 68.8 }
                    ],
                    benchmarks: {
                        nifty50: [100, 102.1, 105.3, 108.7, 111.2, 114.8, 118.5],
                        nifty500: [100, 101.8, 104.9, 107.8, 110.5, 113.7, 117.2]
                    }
                };
            }

            async loadNeuralNetworks() {
                console.log('ðŸ§  Loading Neural Network Models...');
                
                try {
                    this.updateStatus('neuralStatus', 'Loading LSTM models...', 'loading');
                    
                    // Simulate loading a simple prediction model
                    await new Promise(resolve => setTimeout(resolve, 3000));
                    
                    // Create a simple sequential model for demonstration
                    this.neuralModel = tf.sequential({
                        layers: [
                            tf.layers.dense({ inputShape: [10], units: 50, activation: 'relu' }),
                            tf.layers.dense({ units: 25, activation: 'relu' }),
                            tf.layers.dense({ units: 1, activation: 'linear' })
                        ]
                    });
                    
                    this.neuralModel.compile({
                        optimizer: 'adam',
                        loss: 'meanSquaredError'
                    });
                    
                    this.isNeuralModelLoaded = true;
                    this.updateStatus('neuralStatus', 'Neural networks loaded successfully', 'live');
                    
                    // Show neural predictions panel
                    document.getElementById('neuralStatus').style.display = 'none';
                    document.getElementById('neuralPredictions').style.display = 'block';
                    
                    await this.generateNeuralPredictions();
                    console.log('âœ… Neural networks loaded successfully');
                    
                } catch (error) {
                    console.error('âŒ Neural network loading failed:', error);
                    this.updateStatus('neuralStatus', 'Neural network error', 'error');
                    this.handleError('Neural Network Loading', error);
                }
            }

            async updateLiveNAVs() {
                console.log('ðŸ“ˆ Updating Live NAVs from AMFI...');
                
                try {
                    this.updateStatus('navStatus', 'Fetching NAVs...', 'loading');
                    
                    for (let fund of this.funds) {
                        try {
                            // Use AMFI API for real NAV data
                            const response = await fetch(`https://api.mfapi.in/mf/${fund.amfiCode}`);
                            
                            if (response.ok) {
                                const data = await response.json();
                                const latestData = data.data[0];
                                
                                fund.previousNAV = fund.currentNAV;
                                fund.currentNAV = parseFloat(latestData.nav);
                                fund.currentValue = fund.units * fund.currentNAV;
                                fund.lastUpdated = new Date();
                                
                                console.log(`âœ… ${fund.fundName}: â‚¹${fund.currentNAV}`);
                            } else {
                                throw new Error(`API response not OK: ${response.status}`);
                            }
                            
                            // Rate limiting to avoid API throttling
                            await new Promise(resolve => setTimeout(resolve, 500));
                            
                        } catch (error) {
                            console.error(`âŒ NAV fetch failed for ${fund.fundName}:`, error);
                            // Keep existing NAV with small variation for demo
                            fund.currentNAV += (Math.random() - 0.5) * 0.01 * fund.currentNAV;
                            fund.currentValue = fund.units * fund.currentNAV;
                        }
                    }
                    
                    this.updateStatus('navStatus', 'NAVs updated successfully', 'live');
                    this.renderHoldingsTable();
                    this.updatePortfolioSummary();
                    console.log('âœ… NAV updates completed');
                    
                } catch (error) {
                    console.error('âŒ NAV update process failed:', error);
                    this.updateStatus('navStatus', 'NAV update failed', 'error');
                }
            }

            async updateMarketData() {
                console.log('ðŸŒ Updating Market Data...');
                
                try {
                    // Update EUR/INR and USD/INR rates
                    const eurResponse = await fetch('https://api.exchangerate-api.com/v4/latest/EUR');
                    const usdResponse = await fetch('https://api.exchangerate-api.com/v4/latest/USD');
                    
                    if (eurResponse.ok && usdResponse.ok) {
                        const eurData = await eurResponse.json();
                        const usdData = await usdResponse.json();
                        
                        const eurInr = eurData.rates.INR;
                        const usdInr = usdData.rates.INR;
                        
                        document.getElementById('eurInr').textContent = `â‚¹${eurInr.toFixed(2)}`;
                        document.getElementById('usdInr').textContent = `â‚¹${usdInr.toFixed(2)}`;
                        
                        // Calculate changes (simplified)
                        const eurChange = ((eurInr - 91.20) / 91.20 * 100).toFixed(2);
                        const usdChange = ((usdInr - 83.50) / 83.50 * 100).toFixed(2);
                        
                        document.getElementById('eurChange').textContent = `${eurChange >= 0 ? '+' : ''}${eurChange}%`;
                        document.getElementById('usdChange').textContent = `${usdChange >= 0 ? '+' : ''}${usdChange}%`;
                        
                        document.getElementById('eurChange').className = eurChange >= 0 ? 'positive' : 'negative';
                        document.getElementById('usdChange').className = usdChange >= 0 ? 'positive' : 'negative';
                    }
                    
                    // Simulate other market data updates
                    const nifty = 24613 + (Math.random() - 0.5) * 100;
                    const gold = 6891 + (Math.random() - 0.5) * 50;
                    
                    document.getElementById('nifty50').textContent = nifty.toFixed(0);
                    document.getElementById('goldPrice').textContent = `â‚¹${gold.toFixed(0)}`;
                    
                } catch (error) {
                    console.error('âŒ Market data update failed:', error);
                }
            }

            async generateNeuralPredictions() {
                if (!this.isNeuralModelLoaded) return;
                
                console.log('ðŸ”® Generating Neural Predictions...');
                
                try {
                    for (let fund of this.funds) {
                        // Prepare input data (simplified for demo)
                        const inputData = tf.tensor2d([[
                            fund.currentNAV / 100,
                            (fund.currentNAV - fund.previousNAV) / fund.previousNAV,
                            (fund.currentNAV - fund.weekAgoNAV) / fund.weekAgoNAV,
                            fund.allocation / 100,
                            Math.random(), // Market sentiment score
                            Math.random(), // Technical indicator
                            Math.random(), // Volume factor
                            Math.random(), // Volatility
                            Math.random(), // Sector performance
                            Math.random()  // General market trend
                        ]]);
                        
                        const prediction = this.neuralModel.predict(inputData);
                        const predictionValue = await prediction.data();
                        
                        fund.neuralPrediction = (predictionValue[0] * 10).toFixed(1); // Convert to percentage
                        fund.aiScore = (5 + Math.random() * 5).toFixed(1); // Simulated AI score
                        
                        inputData.dispose();
                        prediction.dispose();
                    }
                    
                    // Update overall predictions
                    const avg7d = this.funds.reduce((sum, fund) => sum + parseFloat(fund.neuralPrediction), 0) / this.funds.length;
                    const avg30d = avg7d * 2.8; // Simplified 30-day projection
                    
                    document.getElementById('pred7d').textContent = `${avg7d >= 0 ? '+' : ''}${avg7d.toFixed(1)}%`;
                    document.getElementById('pred30d').textContent = `${avg30d >= 0 ? '+' : ''}${avg30d.toFixed(1)}%`;
                    document.getElementById('conf7d').textContent = '87%';
                    document.getElementById('conf30d').textContent = '72%';
                    
                    this.renderNeuralChart();
                    console.log('âœ… Neural predictions generated');
                    
                } catch (error) {
                    console.error('âŒ Neural prediction failed:', error);
                }
            }

            renderAllPanels() {
                this.renderHoldingsTable();
                this.renderSIPTracking();
                this.renderPerformanceAnalytics();
                this.renderSIPHistory();
                this.updatePortfolioSummary();
            }

            renderHoldingsTable() {
                const tbody = document.getElementById('holdingsTableBody');
                tbody.innerHTML = '';
                
                this.funds.forEach(fund => {
                    const dayChange = this.calculateChange(fund.currentNAV, fund.previousNAV);
                    const weekChange = this.calculateChange(fund.currentNAV, fund.weekAgoNAV);
                    const pnl = fund.currentValue - fund.investedValue;
                    const pnlPercent = (pnl / fund.investedValue * 100);
                    
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>
                            <div style="display: flex; align-items: center; gap: 8px;">
                                <div style="width: 6px; height: 20px; background: ${this.getCategoryColor(fund.category)}; border-radius: 3px;"></div>
                                <div>
                                    <strong style="font-size: 0.85rem;">${fund.fundName.split(' - ')[0]}</strong>
                                    <div style="font-size: 0.7rem; color: #64748b;">${fund.category}</div>
                                    ${fund.lastUpdated ? `<div style="font-size: 0.6rem; color: #22c55e;">Updated: ${fund.lastUpdated.toLocaleTimeString()}</div>` : '<div style="font-size: 0.6rem; color: #f59e0b;">Pending update</div>'}
                                </div>
                            </div>
                        </td>
                        <td><strong>â‚¹${fund.currentNAV.toFixed(4)}</strong></td>
                        <td>
                            <div class="${dayChange >= 0 ? 'positive' : 'negative'}">
                                <i class="fas fa-${dayChange >= 0 ? 'arrow-up' : 'arrow-down'}"></i>
                                ${dayChange.toFixed(2)}%
                            </div>
                        </td>
                        <td>
                            <div class="${weekChange >= 0 ? 'positive' : 'negative'}">
                                <i class="fas fa-${weekChange >= 0 ? 'arrow-up' : 'arrow-down'}"></i>
                                ${weekChange.toFixed(2)}%
                            </div>
                        </td>
                        <td><strong>â‚¹${fund.currentValue.toLocaleString()}</strong></td>
                        <td>
                            <div class="${pnl >= 0 ? 'positive' : 'negative'}">
                                ${pnl >= 0 ? '+' : ''}â‚¹${Math.abs(pnl).toLocaleString()}
                                <div style="font-size: 0.7rem;">(${pnlPercent.toFixed(2)}%)</div>
                            </div>
                        </td>
                        <td>
                            <div style="font-weight: 600; color: ${this.getScoreColor(fund.aiScore)}">${fund.aiScore}/10</div>
                        </td>
                        <td>
                            <div class="${fund.neuralPrediction >= 0 ? 'positive' : 'negative'}">${fund.neuralPrediction >= 0 ? '+' : ''}${fund.neuralPrediction}%</div>
                        </td>
                        <td>
                            <span style="padding: 3px 8px; border-radius: 10px; font-size: 0.75rem; background: ${fund.status === 'active' ? '#dcfce7' : '#fef3c7'}; color: ${fund.status === 'active' ? '#166534' : '#92400e'};">
                                ${fund.status.toUpperCase()}
                            </span>
                        </td>
                    `;
                    tbody.appendChild(row);
                });
            }

            renderSIPTracking() {
                const sipScheduleDiv = document.getElementById('sipSchedule');
                sipScheduleDiv.innerHTML = '';
                
                this.sipHistory.monthlySIPSchedule.forEach(schedule => {
                    const scheduleDiv = document.createElement('div');
                    scheduleDiv.style.cssText = 'background: #f8fafc; padding: 10px; border-radius: 8px; margin: 5px 0; display: flex; justify-content: space-between; align-items: center;';
                    scheduleDiv.innerHTML = `
                        <div>
                            <strong>${schedule.date}</strong>
                            <div style="font-size: 0.8rem; color: #64748b;">${schedule.funds.length} funds</div>
                        </div>
                        <div style="font-weight: 600; color: #3b82f6;">â‚¹${schedule.amount.toLocaleString()}</div>
                    `;
                    sipScheduleDiv.appendChild(scheduleDiv);
                });
                
                this.updateStatus('sipStatus', 'SIP optimization active', 'live');
                this.renderSIPChart();
            }

            renderPerformanceAnalytics() {
                this.updateStatus('analyticsStatus', 'Performance metrics updated', 'live');
                this.renderPerformanceChart();
            }

            renderSIPHistory() {
                const recentSIPsDiv = document.getElementById('recentSIPs');
                recentSIPsDiv.innerHTML = '';
                
                // Show recent SIP transactions from all funds
                const allSIPs = [];
                this.funds.forEach(fund => {
                    fund.sipHistory.forEach(sip => {
                        allSIPs.push({
                            ...sip,
                            fundName: fund.fundName.split(' - ')[0]
                        });
                    });
                });
                
                // Sort by date and show latest 10
                allSIPs.sort((a, b) => new Date(b.date) - new Date(a.date));
                allSIPs.slice(0, 10).forEach(sip => {
                    const sipDiv = document.createElement('div');
                    sipDiv.className = 'sip-entry';
                    sipDiv.innerHTML = `
                        <div>
                            <strong>${sip.fundName}</strong>
                            <div style="font-size: 0.7rem; color: #64748b;">${sip.date}</div>
                        </div>
                        <div>
                            <div>â‚¹${sip.amount.toLocaleString()}</div>
                            <div style="font-size: 0.7rem; color: #64748b;">${sip.units.toFixed(2)} units</div>
                        </div>
                    `;
                    recentSIPsDiv.appendChild(sipDiv);
                });
                
                this.renderSIPHistoryChart();
            }

            renderSIPChart() {
                const ctx = document.getElementById('sipChart');
                if (!ctx) return;
                
                new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: this.funds.filter(f => f.sipAmount > 0).map(f => f.fundName.split(' ')[0]),
                        datasets: [{
                            data: this.funds.filter(f => f.sipAmount > 0).map(f => f.sipAmount),
                            backgroundColor: this.funds.filter(f => f.sipAmount > 0).map(f => this.getCategoryColor(f.category)),
                            borderWidth: 2,
                            borderColor: '#fff'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { position: 'bottom', labels: { font: { size: 10 } } }
                        }
                    }
                });
            }

            renderPerformanceChart() {
                const ctx = document.getElementById('performanceChart');
                if (!ctx) return;
                
                new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: this.performanceHistory.monthly.map(m => m.month),
                        datasets: [{
                            label: 'Portfolio Value',
                            data: this.performanceHistory.monthly.map(m => m.value),
                            borderColor: '#3b82f6',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            borderWidth: 3,
                            fill: true
                        }, {
                            label: 'Invested Amount',
                            data: this.performanceHistory.monthly.map(m => m.invested),
                            borderColor: '#64748b',
                            borderWidth: 2,
                            fill: false
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { position: 'top' }
                        },
                        scales: {
                            y: {
                                ticks: {
                                    callback: function(value) {
                                        return 'â‚¹' + (value / 1000).toFixed(0) + 'K';
                                    }
                                }
                            }
                        }
                    }
                });
            }

            renderNeuralChart() {
                const ctx = document.getElementById('neuralChart');
                if (!ctx) return;
                
                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: this.funds.map(f => f.fundName.split(' ')[0]),
                        datasets: [{
                            label: 'Neural Prediction (%)',
                            data: this.funds.map(f => parseFloat(f.neuralPrediction)),
                            backgroundColor: this.funds.map(f => parseFloat(f.neuralPrediction) >= 0 ? '#22c55e' : '#ef4444'),
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    callback: function(value) {
                                        return value + '%';
                                    }
                                }
                            }
                        }
                    }
                });
            }

            renderSIPHistoryChart() {
                const ctx = document.getElementById('sipHistoryChart');
                if (!ctx) return;
                
                new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul'],
                        datasets: [{
                            label: 'Monthly SIP Amount',
                            data: [12000, 13000, 14000, 14500, 14500, 14500, 14500],
                            borderColor: '#f59e0b',
                            backgroundColor: 'rgba(245, 158, 11, 0.1)',
                            borderWidth: 3,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false }
                        },
                        scales: {
                            y: {
                                ticks: {
                                    callback: function(value) {
                                        return 'â‚¹' + (value / 1000).toFixed(0) + 'K';
                                    }
                                }
                            }
                        }
                    }
                });
            }

            updatePortfolioSummary() {
                const totalValue = this.funds.reduce((sum, fund) => sum + fund.currentValue, 0);
                const totalSIP = this.funds.reduce((sum, fund) => sum + fund.sipAmount, 0);
                
                document.getElementById('totalValue').textContent = totalValue.toLocaleString();
                document.getElementById('totalSIP').textContent = totalSIP.toLocaleString();
            }

            calculateChange(current, previous) {
                if (!previous || previous === 0) return 0;
                return ((current - previous) / previous * 100);
            }

            getCategoryColor(category) {
                const colors = {
                    'Sectoral': '#ef4444',
                    'Gold ETF': '#f59e0b',
                    'Index Fund': '#22c55e',
                    'Conservative Hybrid': '#3b82f6',
                    'Flexi Cap': '#8b5cf6',
                    'ELSS': '#ec4899',
                    'Small Cap': '#06b6d4',
                    'International': '#64748b'
                };
                return colors[category] || '#64748b';
            }

            getScoreColor(score) {
                if (score >= 7) return '#22c55e';
                if (score >= 5) return '#f59e0b';
                return '#ef4444';
            }

            updateStatus(elementId, message, status) {
                const element = document.getElementById(elementId);
                if (element) {
                    element.textContent = message;
                }
                
                const indicator = document.getElementById(elementId.replace('Status', 'Indicator'));
                if (indicator) {
                    indicator.className = `status-indicator status-${status}`;
                }
            }

            updateTimestamp() {
                const now = new Date();
                const timeString = now.toLocaleString('en-IN', { 
                    timeZone: 'Asia/Kolkata',
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit'
                });
                document.getElementById('lastUpdate').textContent = `Last Update: ${timeString}`;
            }

            startAutoRefresh() {
                console.log('â° Starting auto-refresh (30 minutes)');
                
                setInterval(async () => {
                    console.log('ðŸ”„ Auto-refresh triggered');
                    await this.updateLiveNAVs();
                    await this.updateMarketData();
                    if (this.isNeuralModelLoaded) {
                        await this.generateNeuralPredictions();
                    }
                    this.updateTimestamp();
                }, this.navUpdateInterval);
                
                // Update timestamp every minute
                setInterval(() => this.updateTimestamp(), 60000);
            }

            handleError(context, error) {
                console.error(`Error in ${context}:`, error);
                
                const errorDiv = document.createElement('div');
                errorDiv.className = 'error-message';
                errorDiv.innerHTML = `
                    <strong>Error in ${context}:</strong> ${error.message}
                    <button onclick="this.parentElement.remove()" style="float: right; background: none; border: none; color: #dc2626; cursor: pointer;">âœ•</button>
                `;
                
                document.querySelector('.container').insertBefore(errorDiv, document.querySelector('.dashboard-grid'));
                
                setTimeout(() => errorDiv.remove(), 10000);
            }

            saveDataToLocalStorage() {
                localStorage.setItem('portfolioFunds', JSON.stringify(this.funds));
                localStorage.setItem('sipHistory', JSON.stringify(this.sipHistory));
                localStorage.setItem('performanceHistory', JSON.stringify(this.performanceHistory));
            }
        }

        // Global Functions
        let portfolioManager;

        async function refreshNAVs() {
            console.log('ðŸ”„ Manual NAV refresh triggered');
            await portfolioManager.updateLiveNAVs();
            showNotification('NAVs refreshed successfully', 'success');
        }

        function exportData() {
            const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
            const csvContent = "data:text/csv;charset=utf-8," + 
                "Fund Name,ISIN,Category,Current NAV,Current Value,P&L,AI Score,Neural Pred,SIP Amount,Status\n" +
                portfolioManager.funds.map(fund => {
                    const pnl = fund.currentValue - fund.investedValue;
                    return [
                        `"${fund.fundName}"`,
                        fund.isin,
                        fund.category,
                        fund.currentNAV.toFixed(4),
                        fund.currentValue.toFixed(2),
                        pnl.toFixed(2),
                        fund.aiScore,
                        fund.neuralPrediction,
                        fund.sipAmount || 0,
                        fund.status
                    ].join(',');
                }).join('\n');

            const encodedUri = encodeURI(csvContent);
            const link = document.createElement('a');
            link.setAttribute('href', encodedUri);
            link.setAttribute('download', `portfolio_data_${timestamp}.csv`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showNotification('Portfolio data exported successfully', 'success');
        }

        function exportSIPData() {
            const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
            let csvContent = "data:text/csv;charset=utf-8,";
            csvContent += "Fund Name,Date,Amount,NAV,Units Purchased\n";
            
            portfolioManager.funds.forEach(fund => {
                fund.sipHistory.forEach(sip => {
                    csvContent += `"${fund.fundName}",${sip.date},${sip.amount},${sip.nav},${sip.units}\n`;
                });
            });

            const encodedUri = encodeURI(csvContent);
            const link = document.createElement('a');
            link.setAttribute('href', encodedUri);
            link.setAttribute('download', `sip_history_${timestamp}.csv`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showNotification('SIP data exported successfully', 'success');
        }

        function viewFullSIPHistory() {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%;
                background: rgba(0,0,0,0.5); z-index: 1000; display: flex;
                justify-content: center; align-items: center;
            `;
            
            modal.innerHTML = `
                <div style="background: white; border-radius: 15px; padding: 30px; max-width: 800px; max-height: 80vh; overflow-y: auto;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3>Complete SIP Transaction History</h3>
                        <button onclick="this.closest('.modal').remove()" style="background: none; border: none; font-size: 24px; cursor: pointer;">Ã—</button>
                    </div>
                    <div id="fullSIPHistory"></div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Populate full history
            const historyDiv = modal.querySelector('#fullSIPHistory');
            portfolioManager.funds.forEach(fund => {
                fund.sipHistory.forEach(sip => {
                    const sipRow = document.createElement('div');
                    sipRow.style.cssText = 'display: flex; justify-content: space-between; padding: 10px; border-bottom: 1px solid #e5e7eb;';
                    sipRow.innerHTML = `
                        <div>
                            <strong>${fund.fundName.split(' - ')[0]}</strong>
                            <div style="font-size: 0.8rem; color: #64748b;">${sip.date}</div>
                        </div>
                        <div style="text-align: right;">
                            <div>â‚¹${sip.amount.toLocaleString()}</div>
                            <div style="font-size: 0.8rem; color: #64748b;">${sip.units.toFixed(2)} units @ â‚¹${sip.nav}</div>
                        </div>
                    `;
                    historyDiv.appendChild(sipRow);
                });
            });
        }

        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed; top: 20px; right: 20px; 
                background: ${type === 'success' ? '#22c55e' : '#ef4444'}; 
                color: white; padding: 15px 20px; border-radius: 10px;
                box-shadow: 0 10px 30px rgba(0,0,0,0.2); z-index: 1000;
                transform: translateX(100%); transition: transform 0.3s ease;
            `;
            notification.innerHTML = `
                <div style="display: flex; align-items: center; gap: 10px;">
                    <i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-circle'}"></i>
                    <span>${message}</span>
                </div>
            `;
            
            document.body.appendChild(notification);
            setTimeout(() => notification.style.transform = 'translateX(0)', 100);
            setTimeout(() => {
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => notification.remove(), 300);
            }, 4000);
        }

        // Initialize Fixed Portfolio Manager
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ðŸš€ Starting Fixed Portfolio Manager...');
            portfolioManager = new FixedPortfolioManager();
            
            setTimeout(() => {
                showNotification('Fixed portfolio dashboard loaded with all corrections!', 'success');
            }, 2000);
        });
    </script>
</body>
</html>
